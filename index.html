<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏ –ø—Ä–æ—Ç–∏–≤ –ù–µ–ø–æ–±–µ–¥–∏–º–æ–≥–æ –ë–æ—Ç–∞</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 50px;
    }
    table {
      margin: 0 auto;
      border-collapse: collapse;
    }
    td {
      width: 100px;
      height: 100px;
      font-size: 40px;
      text-align: center;
      vertical-align: middle;
      border: 2px solid black;
      cursor: pointer;
    }
    #status {
      margin-top: 20px;
      font-size: 24px;
    }
    #scoreboard {
      margin-top: 10px;
      font-size: 20px;
    }
    #restart {
      margin-top: 15px;
      padding: 10px 20px;
      font-size: 18px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<h1>–ö—Ä–µ—Å—Ç–∏–∫–∏-–ù–æ–ª–∏–∫–∏</h1>
<p>–¢—ã ‚Äî X, –ë–æ—Ç ‚Äî O</p>

<table id="board"></table>

<div id="status">–¢–≤–æ–π —Ö–æ–¥!</div>

<div id="scoreboard">
  üë§ –¢—ã: <span id="playerScore">0</span> | 
  ü§ñ –ë–æ—Ç: <span id="botScore">0</span> | 
  üòê –ù–∏—á—å–∏—Ö: <span id="draws">0</span>
</div>

<button id="restart">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>

<script>
  const boardElement = document.getElementById('board');
  const statusElement = document.getElementById('status');
  const restartButton = document.getElementById('restart');

  let board = Array(9).fill(null);
  let playerScore = 0;
  let botScore = 0;
  let drawScore = 0;

  const playerScoreEl = document.getElementById('playerScore');
  const botScoreEl = document.getElementById('botScore');
  const drawScoreEl = document.getElementById('draws');

  restartButton.addEventListener('click', resetGame);

  function renderBoard() {
    boardElement.innerHTML = '';
    for (let i = 0; i < 3; i++) {
      const row = document.createElement('tr');
      for (let j = 0; j < 3; j++) {
        const cell = document.createElement('td');
        const index = i * 3 + j;
        cell.textContent = board[index] || '';
        cell.addEventListener('click', () => playerMove(index));
        row.appendChild(cell);
      }
      boardElement.appendChild(row);
    }
  }

  function playerMove(index) {
    if (board[index] || checkWinner(board) || isDraw(board)) return;
    board[index] = 'X';
    renderBoard();
    updateStatus();

    if (!checkWinner(board) && !isDraw(board)) {
      setTimeout(botMove, 200); // –Ω–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —Ä–µ–∞–ª–∏–∑–º–∞
    }
  }

  function botMove() {
    const bestMove = getBestMove(board);
    if (bestMove !== -1) {
      board[bestMove] = 'O';
      renderBoard();
    }
    updateStatus();
  }

  function getBestMove(newBoard) {
    let bestScore = -Infinity;
    let move = -1;
    for (let i = 0; i < newBoard.length; i++) {
      if (!newBoard[i]) {
        newBoard[i] = 'O';
        let score = minimax(newBoard, 0, false);
        newBoard[i] = null;
        if (score > bestScore) {
          bestScore = score;
          move = i;
        }
      }
    }
    return move;
  }

  function minimax(boardState, depth, isMaximizing) {
    const winner = checkWinner(boardState);
    if (winner === 'O') return 10 - depth;
    if (winner === 'X') return depth - 10;
    if (isDraw(boardState)) return 0;

    if (isMaximizing) {
      let bestScore = -Infinity;
      for (let i = 0; i < boardState.length; i++) {
        if (!boardState[i]) {
          boardState[i] = 'O';
          let score = minimax(boardState, depth + 1, false);
          boardState[i] = null;
          bestScore = Math.max(score, bestScore);
        }
      }
      return bestScore;
    } else {
      let bestScore = Infinity;
      for (let i = 0; i < boardState.length; i++) {
        if (!boardState[i]) {
          boardState[i] = 'X';
          let score = minimax(boardState, depth + 1, true);
          boardState[i] = null;
          bestScore = Math.min(score, bestScore);
        }
      }
      return bestScore;
    }
  }

  function checkWinner(b) {
    const wins = [
      [0,1,2], [3,4,5], [6,7,8],
      [0,3,6], [1,4,7], [2,5,8],
      [0,4,8], [2,4,6]
    ];
    for (let [a, b1, c] of wins) {
      if (b[a] && b[a] === b[b1] && b[a] === b[c]) return b[a];
    }
    return null;
  }

  function isDraw(b) {
    return b.every(cell => cell) && !checkWinner(b);
  }

  function updateStatus() {
    const winner = checkWinner(board);
    if (winner) {
      if (winner === 'X') {
        statusElement.textContent = '–¢—ã –ø–æ–±–µ–¥–∏–ª! –ö–∞–∫?!';
        playerScore++;
      } else {
        statusElement.textContent = '–ë–æ—Ç –ø–æ–±–µ–¥–∏–ª! –ë—ã–ª–æ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ.';
        botScore++;
      }
    } else if (isDraw(board)) {
      statusElement.textContent = '–ù–∏—á—å—è. –ü–æ—á—Ç–∏ –ø–æ–±–µ–¥–∞!';
      drawScore++;
    } else {
      statusElement.textContent = '–¢–≤–æ–π —Ö–æ–¥!';
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á—ë—Ç
    playerScoreEl.textContent = playerScore;
    botScoreEl.textContent = botScore;
    drawScoreEl.textContent = drawScore;
  }

  function resetGame() {
    board = Array(9).fill(null);
    renderBoard();
    updateStatus();
  }

  renderBoard();
</script>

</body>
</html>

